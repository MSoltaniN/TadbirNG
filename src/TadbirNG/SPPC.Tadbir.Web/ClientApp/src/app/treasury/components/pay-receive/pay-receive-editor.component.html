<app-bread-cumb
  entityType="{{
    subjectMode === 1 ? 'DraftVoucherEditor' : 'VoucherEditor'
  }}"
  *ngIf="isShowBreadcrumb"
></app-bread-cumb>
<!-- <view-identifier [ViewID]="viewId">
  <report-param ParamName="no" [ParamValue]="currentVoucherNo"></report-param>
</view-identifier>
<report-viewer id="compviewer"></report-viewer>
<report-management [ViewIdentity]="viewIdentity"></report-management> -->

<div class="panel-body" style="padding-top: 0">
  <div *ngIf="errorMessages">
    <div *ngFor="let err of errorMessages" class="alert alert-danger">
      <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
      {{ err }}
    </div>
  </div>

  <div>
    <form novalidate [formGroup]="form1" (keydown.enter)="onSave($event)">
      <div class="row">
        <div class="col-xs-12 sppc-float" style="margin-top: 5px">
          <button
            class="k-button sh-new-voucher"
            title="{{ 'Voucher.NewVoucher' | translate }}"
            SppcPermissionCheck="Create"
            [EntityName]="entityType"
            (sppcClick)="payReceiveOperation(payReceiveOperationsItem.New)"
          >
            <span class="k-icon k-i-file-add"></span>
          </button>

          <button
            SppcPermissionCheck="Delete"
            [EntityName]="entityType"
            (sppcClick)="removeHandler()"
            class="k-button sh-remove-voucher"
            title="{{ 'Buttons.Delete' | translate }}"
          >
            <span class="k-icon k-i-delete"></span>
          </button>

          <button
            class="k-button"
            title="{{ 'Voucher.SearchVoucher' | translate }}"
            (click)="payReceiveOperation(payReceiveOperationsItem.Search)"
          >
            <span class="k-icon k-i-search"></span>
          </button>

          <button
            class="k-button not-change"
            title="{{ 'Voucher.FirstVoucher' | translate }}"
            [attr.disabled]="isFirstItem ? true : null"
            SppcPermissionCheck="Navigate"
            [EntityName]="entityType"
            (sppcClick)="payReceiveOperation(payReceiveOperationsItem.First)"
          >
            <span class="k-icon k-i-arrow-end-right"></span>
          </button>

          <button
            class="k-button not-change"
            [attr.disabled]="isFirstItem ? true : null"
            title="{{ 'Voucher.PreviousVoucher' | translate }}"
            SppcPermissionCheck="Navigate"
            [EntityName]="entityType"
            (sppcClick)="payReceiveOperation(payReceiveOperationsItem.Previous)"
          >
            <span class="k-icon k-i-arrow-double-60-right"></span>
          </button>

          <button
            class="k-button not-change"
            [attr.disabled]="isLastItem ? true : null"
            title="{{ 'Voucher.NextVoucher' | translate }}"
            SppcPermissionCheck="Navigate"
            [EntityName]="entityType"
            (sppcClick)="payReceiveOperation(payReceiveOperationsItem.Next)"
          >
            <span class="k-icon k-i-arrow-double-60-left"></span>
          </button>

          <button
            class="k-button not-change"
            title="{{ 'Voucher.LastVoucher' | translate }}"
            [attr.disabled]="isLastItem ? true : null"
            SppcPermissionCheck="Navigate"
            [EntityName]="entityType"
            (sppcClick)="payReceiveOperation(payReceiveOperationsItem.Last)"
          >
            <span class="k-icon k-i-arrow-end-left"></span>
          </button>

          <button
            class="k-button"
            [disabled]="form1.status == 'INVALID'"
            SppcPermissionCheck="Edit"
            [EntityName]="entityType"
            (sppcClick)="onSave($event)"
            title="{{ 'Voucher.Save' | translate }}"
          >
            <span class="k-icon k-i-save"></span>
          </button>

          <button
            kendoButton
            SppcPermissionCheck="Print"
            [EntityName]="entityType"
            (sppcClick)="showReport()"
            class="hidden-xs rm print sh-print"
            type="button"
            [icon]="'printer'"
          ></button>

          <button
            class="k-button k-button-icon sppc-float-diff"
            title="{{ 'Buttons.Help' | translate }}"
          >
            <span class="k-icon k-i-help"></span>
          </button>
        </div>
      </div>

      <div class="row">
        <div class="col-xs-12">
          <div class="pr-form-content">
            <div class="col-sm-5ths col-xs-12 sppc-float">
              <div class="form-group">
                <label for="no" class="control-label">{{
                  "Voucher.No" | translate
                }}</label>

                <input
                  type="text"
                  class="k-textbox"
                  formControlName="payReceiveNo"
                  [OnlyNumber]
                  [attr.disabled]="
                    isConfirmed ? 'disabled' : null
                  "
                />

                <div
                  class="k-tooltip k-tooltip-validation"
                  [hidden]="
                    form1.controls.payReceiveNo.valid || form1.controls.payReceiveNo.pristine
                  "
                >
                  <span *ngIf="form1.controls.payReceiveNo.errors?.required">{{
                    "AllValidations.Voucher.NoIsRequired" | translate
                  }}</span>
                  <span *ngIf="form1.controls.payReceiveNo.errors?.maxlength">{{
                    "AllValidations.Voucher.NoIsTooLong" | translate
                  }}</span>
                </div>
              </div>
            </div>

            <div class="col-sm-5ths col-xs-12 sppc-float">
              <div class="form-group">
                <label for="reference" class="control-label">{{
                  "Voucher.Reference" | translate
                }}</label>

                <input
                  type="text"
                  class="k-textbox"
                  formControlName="reference"
                  [attr.disabled]="
                    isConfirmed ? 'disabled' : null
                  "
                />

                <div
                  class="k-tooltip k-tooltip-validation"
                  [hidden]="
                    form1.controls.reference.valid ||
                    form1.controls.reference.pristine
                  "
                >
                  <span *ngIf="form1.controls.reference.errors?.maxlength">{{
                    "AllValidations.Voucher.ReferenceIsTooLong" | translate
                  }}</span>
                </div>
              </div>
            </div>

            <div class="col-sm-5ths col-xs-12 sppc-float">
              <div class="form-group">
                <label for="date" class="control-label">{{
                  "Voucher.Date" | translate
                }}</label>

                <sppc-datepicker
                  [isReadOnly]="isConfirmed"
                  formControlName="date"
                  [minDate]="FiscalPeriodStartDate"
                  [maxDate]="FiscalPeriodEndDate"
                  [displayType]="'voucherDateType'"
                ></sppc-datepicker>
              </div>
            </div>

            <div class="col-md-6 sppc-float">
                <div class="form-group">
                    <label for="date" class="control-label">{{
                    "Voucher.Date" | translate
                    }}</label>
    
                    <payer-receiver></payer-receiver>
                </div>
            </div>

            <div class="clearfix"></div>
          </div>
        </div>
      </div>
    </form>

    <div class="row">
      <div class="col-xs-12">
        <div class="pr-form-content">
          <pay-recive-cheks [urlPath]="urlPath" style="width: 100%;"></pay-recive-cheks>
        </div>
      </div>
    </div>
  </div>
</div>

<kendo-dialog
  title="{{ 'Voucher.Delete' | translate }}"
  *ngIf="deleteConfirm"
  (close)="deleteModel(false)"
  [minWidth]="250"
  [width]="450"
>
  <p >
    {{ this.deleteConfirmMsg }}
  </p>
  <kendo-dialog-actions>
    <button class="k-button" (click)="deleteModel(true)" primary="true">
      {{ "Buttons.Yes" | translate }}
    </button>
    <button class="k-button" (click)="deleteModel(false)">
      {{ "Buttons.No" | translate }}
    </button>
  </kendo-dialog-actions>
</kendo-dialog>
