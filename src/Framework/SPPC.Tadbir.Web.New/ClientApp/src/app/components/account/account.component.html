
<app-bread-cumb></app-bread-cumb>

<kendo-splitter orientation="vertical" style="height:calc(100vh - 95px);">

  <kendo-splitter-pane>
    <kendo-splitter>

      <kendo-splitter-pane [collapsible]="true" size="20%" #treeContent [scrollTop]="treeScrollTop" class="hidden-xs">

        <div style="height:100px">
          <div [ngClass]="{'k-rtl':this.CurrentLanguage === 'fa'}" style="margin-top:15px;">

            <kendo-treeview [nodes]="firstTreeNode"
                            textField="name"
                            kendoTreeViewExpandable
                            kendoTreeViewSelectable
                            [hasChildren]="hasChildren"
                            [children]="fetchChildren"
                            [expandBy]="'id'"
                            [(expandedKeys)]="expandedKeys"
                            [selectBy]="'id'"
                            [(selectedKeys)]="selectedKeys"
                            (selectionChange)="handleSelection($event)"
                            (nodeClick)="onNodeClick($event)">
              <ng-template kendoTreeViewNodeTemplate let-dataItem>
                <div id="node-{{dataItem.id}}">
                  {{dataItem.name}}
                </div>
              </ng-template>
            </kendo-treeview>
            
            <kendo-contextmenu #treemenulimited [items]="contextmenuLimitedItems" (select)="onSelectContextmenu($event)">
              <ng-template kendoMenuItemTemplate let-item="item">
                <span [ngClass]="item.icon"></span>
                {{ item.text | translate }}
              </ng-template>
            </kendo-contextmenu>
            <kendo-contextmenu #treemenu [items]="contextmenuItems" (select)="onSelectContextmenu($event)">
              <ng-template kendoMenuItemTemplate let-item="item">
                <span [ngClass]="item.icon"></span>
                {{ item.text | translate }}
              </ng-template>
            </kendo-contextmenu>

          </div>
        </div>

      </kendo-splitter-pane>

      <kendo-splitter-pane>

        <div>
          <div SppcCheckAccess="View">
            <kendo-grid id="1" [ngClass]="{'tRtl':this.currentlang === 'fa' , 'tLtr': this.currentlang === 'en'}" #GridID [data]="rowData"
                        [sortable]="{ allowUnsort: true, mode: 'multiple' }"
                        [sort]="sort"
                        [pageSize]="pageSize"
                        [skip]="skip"
                        [filter]="state.filter"
                        [pageable]="true"
                        [resizable]="true"
                        [filterable]="true"
                        [scrollable]="'none'"
                        (pageChange)="pageChange($event)"
                        (sortChange)="sortChange($event)"
                        (edit)="editHandler()"
                        (remove)="removeHandler()"
                        [loading]="true"
                        [selectable]="{ checkboxOnly: true, mode: 'multiple' }"
                        [selectedKeys]="selectedRows"
                        [kendoGridSelectBy]="selectionKey"
                        (filterChange)="filterChange($event)"
                        (selectedKeysChange)="onSelectedKeysChange($event)"
                        (cellClick)="onCellClick($event)"
                        (dblclick)="rowDoubleClickHandler()"
                        sppc-grid-reorder sppc-grid-resize>

              <kendo-grid-messages pagerPage="{{ 'Paging.Record' | translate }}"
                                   pagerOf="{{ 'Paging.Of' | translate }}"
                                   pagerItems="{{ 'Paging.Record' | translate }}">
              </kendo-grid-messages>
              <ng-template kendoGridNoRecordsTemplate>
                {{ showloadingMessage  ? ('App.Loading' | translate) : ('App.RecordNotFound' | translate) }}
              </ng-template>
              <ng-template kendoGridToolbarTemplate let-account>

                <section class="content-header" style="padding-top:0;">
                  <h4>{{ parent ? parent.name : this.treeParentTitle }}</h4>
                  <ol class="breadcrumb" style="top:0;" *ngIf="breadCrumbList.length > 1">
                    <li *ngFor="let item of breadCrumbList"><a href="javascript:;" (click)="selectBreadCrumb(item)">{{ item.name }}</a></li>
                  </ol>
                </section>

                <button kendoGridAddCommand SppcPermissionCheck="Create" (sppcClick)="addNew()" [icon]="'file-add'" type="button" title="{{ 'Account.New' | translate }}"></button>

                <button SppcPermissionCheck="Edit" (sppcClick)="editHandler()" class="k-button k-button-icon" [disabled]="selectedRows.length != 1" title="{{ 'Buttons.Edit' | translate }}"><span class="k-icon k-i-pencil"></span></button>
                <button SppcPermissionCheck="Delete" (sppcClick)="removeHandler()" class="k-button k-button-icon" [disabled]="selectedRows.length == 0" title="{{ 'Buttons.Delete' | translate }}"><span class="k-icon k-i-delete"></span></button>
                <button (click)="subsetHandler()" class="k-button k-button-icon" [disabled]="selectedRows.length != 1" title="{{ 'Buttons.Subset' | translate }}"><span class="k-icon k-i-filter-add-expression"></span></button>

                <grid-setting entityTypeName="Account"></grid-setting>
                <grid-filter *ngIf="this.grid.filterable" [parentComponent]="this" [showClearFilter]="this.grid.filter.filters.length"></grid-filter>
              </ng-template>
              <!-- template for mobile -->
              <kendo-grid-checkbox-column showSelectAll="true" width="25"></kendo-grid-checkbox-column>

              <kendo-grid-column media="(max-width: 450px)" title="">
                <ng-template kendoGridCellTemplate let-account>
                  <!-- template for mobile -->
                  <h4>
                    {{ account.name }}
                  </h4>
                  <dl>
                    <dt>{{ 'Account.Code' | translate }}:</dt>
                    <dd>{{ account.code }}</dd>
                    <dt>{{ 'Account.Name' | translate }}:</dt>
                    <dd>{{ account.name }}</dd>
                    <dt>{{ 'Account.Description' | translate }}:</dt>
                    <dd>{{ account.description }}</dd>
                  </dl>
                </ng-template>
              </kendo-grid-column>
              <!-- template for mobile -->
              <!-- template for mid-size devices -->

              <kendo-grid-column width="150" media="(min-width: 450px) and (max-width: 1024px)" sppc-grid-column="Account.code">
                <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
                  <sppc-grid-filter [metaData]="getMeta('code')" [column]="column" [spinners]="true" [filter]="filter"></sppc-grid-filter>
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column width="250" media="(min-width: 450px) and (max-width: 1024px)" sppc-grid-column="Account.name">
                <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
                  <sppc-grid-filter [metaData]="getMeta('name')" [column]="column" [filter]="filter"></sppc-grid-filter>
                </ng-template>
              </kendo-grid-column>

              <!-- template for mid-size devices -->
              <!-- additional columns on large devices -->
              <kendo-grid-column width="130" media="(min-width: 1024px)" sppc-grid-column="Account.code">
                <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
                  <sppc-grid-filter [metaData]="getMeta('code')" [column]="column" [filter]="filter"></sppc-grid-filter>
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column media="(min-width: 1024px)" width="200" sppc-grid-column="Account.name">
                <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
                  <sppc-grid-filter [metaData]="getMeta('name')" [column]="column" [filter]="filter"></sppc-grid-filter>
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column media="(min-width: 1024px)" width="200" sppc-grid-column="Account.description">
                <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
                  <sppc-grid-filter [metaData]="getMeta('descrption')" [column]="column" [filter]="filter"></sppc-grid-filter>
                </ng-template>
              </kendo-grid-column>
              <!-- additional columns on large devices -->

            </kendo-grid>
          </div>
          <kendo-dialog title="{{'Account.Delete' | translate}}" *ngIf="deleteConfirm" (close)="deleteModel(false)" [minWidth]="250" [width]="450">
            <p>
              {{ this.deleteConfirmMsg }}
            </p>
            <kendo-dialog-actions>
              <button class="k-button" (click)="deleteModel(true)" primary="true">{{ 'Buttons.Yes' | translate }}</button>
              <button class="k-button" (click)="deleteModel(false)">{{ 'Buttons.No' | translate }}</button>
            </kendo-dialog-actions>
          </kendo-dialog>

        </div>

      </kendo-splitter-pane>

    </kendo-splitter>
  </kendo-splitter-pane>
</kendo-splitter>
